aside#sidebar
  div.sidebar-inner
    - let isShowPostToc = theme.toc.enable && is_post()
    if isShowPostToc
      div.sidebar-nav
        span.sidebar-nav-toc.current= _p("sidebar.catalog")
        span.sidebar-nav-overview= _p("sidebar.overview")
    
    section(class=`${isShowPostToc ? "" : "hide"}`).sidebar-toc
      if page.content
        - let tocMaxDepth = page.toc_max_depth || theme.toc.max_depth || 6
        div!= toc(page.content, {list_number: theme.toc.number, max_depth: tocMaxDepth})

    section(class=`${isShowPostToc ? "hide" : ""}`).sidebar-overview
      if theme.author.enable
        div.sidebar-author
          if theme.author.avatar.url
            img(src=theme.author.avatar.url alt="avatar").sidebar-author-avatar

          if theme.author.motto
            p.sidebar-author-motto= theme.author.motto

      if theme.social_setting.enable
        div.sidebar-social
          for value, name in (theme.social || [])
            if name && value
              - let socialItem = value.split('||')
              - let socialLinkPath = _.trim(_.get(socialItem, '[0]'))
              - let socialLinkIcon = _.trim(_.get(socialItem, '[1]'))
              span.sidebar-social-item
                a(href=socialLinkPath target="_blank"
                    title=`${name} → ${socialLinkPath}`)

                  if socialLinkIcon && socialLinkIcon.match("origin:")
                    span!= socialLinkIcon.split("origin:")[1]
                  else
                    i(class=`fa fa-${socialLinkIcon ?
                        socialLinkIcon : "question-circle-o"}`)
                  
                  if !theme.social_setting.icon_only
                    span= name
      
      if theme.feed.enable
        div.sidebar-feed
          - let feedEmail = theme.feed.email
          if feedEmail
            span.sidebar-feed-email
              a(href=feedEmail target="_blank" title=`email → ${feedEmail}`)
                i.fa.fa-envelope.sidebar-feed-icon
                span Email
                span= _p("sidebar.subscribe")
          
          - let feedRSS = theme.feed.rss
          if feedRSS
            span.sidebar-feed-rss
              a(href=url_for(feedRSS) target="_blank" title=`rss → ${url_for(feedRSS)}`)
                i.fa.fa-rss.sidebar-feed-icon
                span RSS
                span= _p("sidebar.subscribe")
      
      if theme.menu
        - let menuArchives   = _.trim(_.get(theme.menu.archives.split('||'), '[0]'))
        - let menuCategories = _.trim(_.get(theme.menu.categories.split('||'), '[0]'))
        - let menuTags       = _.trim(_.get(theme.menu.tags.split('||'), '[0]'))
        div.sidebar-state
          if theme.menu.archives
            div.sidebar-state-item.sidebar-state-posts
              a(href=menuArchives)
                div.sidebar-state-item-count= site.posts.length
                div.sidebar-state-item-name= _p("sidebar.articles")
          if theme.menu.categories
            div.sidebar-state-item.sidebar-state-categories
              a(href=menuCategories)
                div.sidebar-state-item-count= site.categories.length
                div.sidebar-state-item-name= _p("sidebar.categories")
          if theme.menu.tags
            div.sidebar-state-item.sidebar-state-tags
              a(href=menuTags)
                div.sidebar-state-item-count= site.tags.length
                div.sidebar-state-item-name= _p("sidebar.tags")
      
      if theme.creative_commons.enable && theme.creative_commons.sidebar
        - let themeCC = theme.creative_commons
        - let ccLicense = themeCC.license && themeCC.license.toLowerCase()
        - let ccLanguage = (themeCC.language && themeCC.language.toLowerCase()) || "en"
        - let ccURL = `https://creativecommons.org/licenses/${ccLicense}/4.0/deed.${ccLanguage}`
        div.sidebar-cc
          a(href=ccURL target="_blank")
            img(src=url_for(`/${theme.images}/cc-${ccLicense}.svg`) alt="creative commons")

    if theme.reading_progress.enable && is_post()
      div.sidebar-progress
        div.sidebar-progress-read
          span= _p("sidebar.read_info")
          span.sidebar-progress-number
        div.sidebar-progress-line
